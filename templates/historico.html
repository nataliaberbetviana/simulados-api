<!DOCTYPE html>

<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Histórico de Simulados</title>
<style>
body {
font-family: sans-serif;
margin: 0;
padding: 20px;
background-color: #f0f4f7;
color: #333;
}
.container {
max-width: 900px;
margin: auto;
background-color: #fff;
padding: 30px;
border-radius: 8px;
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
h1 {
text-align: center;
color: #0056b3;
margin-bottom: 20px;
}
.info-geral {
background-color: #e3f2fd;
border-left: 4px solid #2196f3;
padding: 15px;
margin-bottom: 25px;
border-radius: 4px;
text-align: center;
}
.info-geral p {
display: inline-block;
margin: 0 15px;
font-weight: bold;
}
table {
width: 100%;
border-collapse: collapse;
margin-top: 20px;
}
th, td {
text-align: left;
padding: 12px;
border-bottom: 1px solid #ddd;
}
th {
background-color: #f2f2f2;
color: #555;
font-weight: bold;
}
tr:hover {
background-color: #f5f5f5;
}
.link-voltar {
display: block;
margin-top: 30px;
text-align: center;
font-weight: bold;
color: #007bff;
text-decoration: none;
}
.link-voltar:last-child {
margin-top: 10px;
}
.btn-reset {
background-color: #d9534f;
color: white;
padding: 8px 15px;
border: none;
border-radius: 5px;
cursor: pointer;
text-decoration: none;
display: inline-block;
margin-top: 20px;
transition: background-color 0.3s;
}
.btn-reset:hover {
background-color: #c9302c;
}
.pontuacao-alta {
color: green;
font-weight: bold;
}
.pontuacao-baixa {
color: red;
font-weight: bold;
}
</style>
</head>
<body>
<div class="container">
<h1>Histórico de Simulados</h1>

    <!-- CORREÇÃO AQUI: Usando a tag <a> para fazer o redirecionamento. -->
    <!-- O return confirm() cancela o clique do <a> se o usuário clicar em Cancelar. -->
    <a href="{{ url_for('resetar_historico') }}" 
       class="btn-reset" 
       onclick="return confirm('ATENÇÃO: Isso apagará TODOS os resultados do banco de dados. Tem certeza?');">
        Limpar Histórico
    </a>
    
    <div class="info-geral">
        <h3>Seu Desempenho Geral</h3>
        <p><strong>Maior Nota:</strong> <span id="maior-nota">{{ maior_nota }}%</span></p>
        <p><strong>Média de Pontuação:</strong> <span id="media-pontuacao">{{ media_pontuacao }}%</span></p>
        <p><strong>Total de Simulados Realizados:</strong> <span id="total-simulados">{{ historico | length }}</span></p>
    </div>

    <h2>Resultados Detalhados</h2>
    <table>
        <thead>
            <tr>
                <th>Simulado</th>
                <th>Data</th>
                <th>Acertos</th>
                <th>Tempo</th>
                <th>Pontuação</th>
            </tr>
        </thead>
        <tbody>
            {% for resultado in historico %}
            <tr>
                <td>{{ resultado.titulo }}</td>
                <td>{{ resultado.data }}</td>
                <td>{{ resultado.acertos }} / {{ resultado.total }}</td>
                <td>{{ resultado.tempo_formatado }}</td>
                <td>
                    <span class="{% if resultado.percentual >= 70 %}pontuacao-alta{% else %}pontuacao-baixa{% endif %}">
                        {{ resultado.percentual }}%
                    </span>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" style="text-align: center;">Nenhum simulado finalizado ainda.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <a class="link-voltar" href="{{ url_for('simulados') }}">Voltar para Simulados</a>
    <a class="link-voltar" href="{{ url_for('home') }}">Voltar para o Início</a>
</div>

</body>
</html>